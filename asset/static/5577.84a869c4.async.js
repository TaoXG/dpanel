"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5577],{57716:function(V,U,n){n.d(U,{Z:function(){return P}});var A=n(5574),r=n.n(A),b=n(15009),s=n.n(b),h=n(99289),F=n.n(h),l=n(67294),B=n(184),p=n(38345),y=n(64317),D=n(5966),K=n(62370),c=n(97462),W=n(42075),f=n(89035),R=n(82346),i=n(28036),u=n(85893);function v(o){var z=(0,l.useState)({height:800,width:1024}),C=r()(z,2),t=C[0],a=C[1],d=function(){var H=window.innerWidth,T=window.innerHeight;a({height:T,width:H})};(0,l.useEffect)(function(){window.addEventListener("resize",function(){d()}),d()},[o]);var e=o.query?Object.keys(o.query).map(function(j){if(o.query)return"".concat(j,"=").concat(o.query[j])}):[];return(0,u.jsx)(R.Link,{target:"_blank",to:"/console/"+o.container+"?width=".concat(t.width,"&height=").concat(t.height,"&").concat(e.join("&")),children:(0,u.jsx)(i.ZP,{type:"primary",icon:(0,u.jsx)(f.Z,{}),children:o.content})})}var _=n(60335),L=n(5251),w=n(49610),O=(0,l.forwardRef)(function(o,z){(0,l.useImperativeHandle)(z,function(){return{show:function(I,m){return F()(s()().mark(function S(){var $,N,M;return s()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,_.jV)({md5:I});case 2:M=Z.sent,m&&m!=""&&(M.data.info.Config.WorkingDir=m),x(M.data.info),j(!0),($=C.current)===null||$===void 0||$.resetFields(),(N=C.current)===null||N===void 0||N.setFieldsValue({workDir:M.data.info.Config.WorkingDir});case 8:case"end":return Z.stop()}},S)}))()}}});var C=(0,l.useRef)(),t=(0,l.useRef)(),a=(0,l.useState)(!1),d=r()(a,2),e=d[0],j=d[1],H=(0,l.useState)(),T=r()(H,2),E=T[0],x=T[1];return(0,l.useEffect)(function(){return E&&setTimeout(function(){var g;(g=t.current)===null||g===void 0||g.start(E.Id,{width:"800",height:"".concat(window.innerHeight),cmd:"/bin/sh",workDir:E.Config.WorkingDir})},1e3),function(){var g;(g=t.current)===null||g===void 0||g.close()}},[E,e]),(0,u.jsxs)(B.a,{drawerProps:{forceRender:!0},onFinish:function(){var g=F()(s()().mark(function I(m){var S,$;return s()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(E){M.next=2;break}return M.abrupt("return",!1);case 2:return(S=t.current)===null||S===void 0||S.close(),($=t.current)===null||$===void 0||$.start(E.Id,{width:"800",height:"".concat(window.innerHeight),cmd:m.entryCmd,workDir:m.workDir}),M.abrupt("return",!1);case 5:case"end":return M.stop()}},I)}));return function(I){return g.apply(this,arguments)}}(),onValuesChange:function(I,m){if(m.entryCmd){var S;(S=C.current)===null||S===void 0||S.submit()}},isKeyPressSubmit:!0,open:e,formRef:C,onOpenChange:function(I){if(j(I),I){var m;(m=t.current)===null||m===void 0||m.fit()}},submitter:!1,title:(0,L.fi)(E?E.Name:"","/")+" \u63A7\u5236\u53F0",children:[(0,u.jsx)(p.Z,{ghost:!0,children:(0,u.jsxs)(W.Z.Compact,{children:[(0,u.jsx)(y.Z,{label:"shell",width:"sm",name:"entryCmd",valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"}}),(0,u.jsx)(D.Z,{width:"sm",label:"\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",disabled:!0}),(0,u.jsx)(K.Z,{label:" ",children:(0,u.jsx)(c.Z,{name:["entryCmd","workDir"],children:function(I){var m=I.entryCmd;return(!m||m=="")&&(m="/bin/sh"),E&&(0,u.jsx)(v,{container:E.Id,query:{cmd:encodeURIComponent(m),workDir:encodeURIComponent(E.Config.WorkingDir)},content:"\u65B0\u7A97\u53E3\u6253\u5F00"})}})})]})}),e&&(0,u.jsx)(w.Z,{showInDrawer:!0,ref:t})]})}),P=O},49610:function(V,U,n){var A=n(67294),r=n(54964),b=n(52626),s=n(12320),h=n.n(s),F=n(78267),l=n.n(F),B=n(85893),p,y=new s.Terminal(r.a),D=new F.FitAddon,K=(0,A.forwardRef)(function(c,W){var f,R=function(){y.reset(),f&&f.dispose(),p&&(p.close(),p=null)},i=function(){y.reset(),D.fit(),y.focus(),f&&f.dispose(),f=y.onData(function(v){var _={content:{command:v},type:"console"};p&&p.send(JSON.stringify(_))})};return(0,A.useImperativeHandle)(W,function(){return{start:function(v,_){var L=_?Object.keys(_).map(function(w){if(_&&_[w])return"".concat(w,"=").concat(_[w])}):[];p=new WebSocket((0,b.R)("/console/"+v+"?"+L.join("&"))),p.addEventListener("message",function(w){var O=JSON.parse(w.data),P=O.type;if(P=="console:"+v&&(y.write(O.data),O.data.indexOf("exec failed")!=-1)){R();return}}),i()},close:function(){R()},fit:function(){D.fit()}}}),(0,A.useEffect)(function(){return y.loadAddon(D),y.open(document.getElementById("terminal-container-console")),D.fit(),function(){R()}},[]),(0,B.jsx)("div",{style:{height:c.showInDrawer?"75vh":"100vh"},id:"terminal-container-console"})});U.Z=K},54964:function(V,U,n){n.d(U,{a:function(){return K}});var A=n(5574),r=n.n(A),b=n(78267),s=n.n(b),h=n(75458),F=n.n(h),l=n(67294),B=n(12320),p=n.n(B),y=n(89629),D=n(85893),K={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,cursorStyle:"block",cursorBlink:!0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},c=new B.Terminal(K),W=new h.SearchAddon,f=new b.FitAddon,R=(0,l.forwardRef)(function(i,u){var v,_=(0,l.useState)(!0),L=r()(_,2),w=L[0],O=L[1];return(0,l.useEffect)(function(){return window.addEventListener("resize",function(){i.showInModal||f.fit()}),i.style&&i.style.fontSize&&(c.options.fontSize=i.style.fontSize),c.loadAddon(f),c.loadAddon(W),c.open(document.getElementById(i.id?i.id:"terminal-container")),i.showInModal||f.fit(),function(){c.reset(),O(!0)}},[]),(0,l.useImperativeHandle)(u,function(){return{write:function(o){w&&(f.fit(),O(!1)),c.write(o)},clear:function(){c.clear()},getTerminal:function(){return c},findNext:function(o){W.findNext(o)},findPrev:function(o){W.findPrevious(o)},fit:function(){f.fit()},onData:function(o){return c.onData(o)}}}),(0,D.jsx)("div",{id:i.id?i.id:"terminal-container",style:{width:i.width?i.width:"100%",height:i.height?i.height:"500px",marginTop:(v=i.style)===null||v===void 0?void 0:v.marginTop}})});U.Z=R},28031:function(V,U,n){n.d(U,{C4:function(){return u},LK:function(){return R},OQ:function(){return _},V9:function(){return F},Yx:function(){return K},ZU:function(){return y},_U:function(){return B},gb:function(){return W},lE:function(){return P},mR:function(){return z},vp:function(){return w}});var A=n(15009),r=n.n(A),b=n(99289),s=n.n(b),h=n(82346);function F(t){return l.apply(this,arguments)}function l(){return l=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/get-path-list",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),l.apply(this,arguments)}function B(t){return p.apply(this,arguments)}function p(){return p=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/export",{data:a,method:"POST",responseType:"blob"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),p.apply(this,arguments)}function y(t){return D.apply(this,arguments)}function D(){return D=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/import",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),D.apply(this,arguments)}function K(t){return c.apply(this,arguments)}function c(){return c=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/delete",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),c.apply(this,arguments)}function W(t){return f.apply(this,arguments)}function f(){return f=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/unzip",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),f.apply(this,arguments)}function R(t){return i.apply(this,arguments)}function i(){return i=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/get-content",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),i.apply(this,arguments)}function u(t){return v.apply(this,arguments)}function v(){return v=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/import-file-content",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),v.apply(this,arguments)}function _(t){return L.apply(this,arguments)}function L(){return L=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/chmod",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),L.apply(this,arguments)}function w(t){return O.apply(this,arguments)}function O(){return O=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/volume/backup",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),O.apply(this,arguments)}function P(t){return o.apply(this,arguments)}function o(){return o=s()(r()().mark(function t(a){var d,e,j;return r()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,R({md5:a.md5,file:"/etc/passwd"});case 2:return d=T.sent,e=[],j=d.data.content,j&&j.split(`
`).map(function(E){var x=E.split(":");x.length<7||e.push({username:x[0],uid:x[2],gid:x[3],description:x[4],homePath:x[5]})}),T.abrupt("return",{data:{list:e},error:"",code:200});case 7:case"end":return T.stop()}},t)})),o.apply(this,arguments)}function z(t){return C.apply(this,arguments)}function C(){return C=s()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.request)("/api/app/explorer/get-file-stat",{data:a,method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t)})),C.apply(this,arguments)}}}]);
